package:
  name: test_output_activation
  version: 1.0

outputs:
  - name: activation_package
    build:
      script:
        - mkdir %PREFIX%\etc\conda\activate.d  # [win]
        - echo set ACTIVATION_VAR=1 > %PREFIX%\etc\conda\activate.d\activate_script.bat  # [win]
        - mkdir -p $PREFIX/etc/conda/activate.d    # [unix]
        - echo "export ACTIVATION_VAR=1" > $PREFIX/etc/conda/activate.d/activate_script.sh  # [unix]
  - name: no_activate_by_default
    script: install_not_activated.sh
    requirements:
      build:
        - {{ pin_subpackage('activation_package') }}
  - name: build_script_activates
    build:
      script:
        - if [ -z "$ACTIVATION_VAR" ]; then echo "build/script not activated" && exit 1; fi   # [unix]
        - IF "%ACTIVATION_VAR%" == "" exit 1             # [win]
    requirements:
      build:
        - {{ pin_subpackage('activation_package') }}
  - name: using_compiler_jinja_activates
    requirements:
      build:
        - {{ compiler('c') }}
        - {{ pin_subpackage('activation_package') }}
    script: install_activated.sh
